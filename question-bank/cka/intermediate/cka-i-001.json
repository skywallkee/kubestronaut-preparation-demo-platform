{
  "id": "cka-i-001",
  "title": "Node Management and Troubleshooting",
  "description": "A worker node named ||worker-node-02|| has been reported as ||NotReady||. Your task is to:\n\n1. Investigate and identify the issue preventing the node from joining the cluster\n2. Fix the kubelet service on the problematic node\n3. Ensure the node becomes ||Ready|| and can schedule pods\n4. Create a test pod named ||node-test|| in namespace ||saturn|| that specifically runs on this node\n\nUse node selectors or node affinity to ensure the test pod runs on ||worker-node-02||.",
  "points": 8,
  "timeLimit": 15,
  "category": "Cluster Management",
  "tags": [
    "node-management",
    "troubleshooting",
    "kubelet",
    "node-affinity",
    "intermediate"
  ],
  "infrastructure": {
    "namespaces": [
      "saturn"
    ],
    "resources": [
      "nodes",
      "pods"
    ],
    "prerequisites": [
      "worker-node-02 configured as NotReady"
    ]
  },
  "solution": {
    "steps": [
      "1. Check node status:",
      "   kubectl get nodes",
      "   kubectl describe node worker-node-02",
      "2. SSH to the problematic node:",
      "   ssh worker-node-02",
      "3. Check kubelet service status:",
      "   sudo systemctl status kubelet",
      "4. Check kubelet logs:",
      "   sudo journalctl -u kubelet -f",
      "5. Restart kubelet service:",
      "   sudo systemctl restart kubelet",
      "   sudo systemctl enable kubelet",
      "6. Verify node becomes Ready:",
      "   kubectl get nodes -w",
      "7. Create test pod with node selector:",
      "   kubectl run node-test --image=nginx --dry-run=client -o yaml > test-pod.yaml",
      "8. Edit YAML to add nodeSelector for worker-node-02",
      "9. Apply the pod:",
      "   kubectl apply -f test-pod.yaml -n saturn"
    ]
  },
  "validations": [
    {
      "command": "kubectl get node worker-node-02 -o jsonpath='{.status.conditions[?(@.type==\"Ready\")].status}'",
      "expected": "True",
      "points": 3,
      "description": "Node worker-node-02 should be in Ready state"
    },
    {
      "command": "kubectl get pod node-test -n saturn -o jsonpath='{.spec.nodeName}'",
      "expected": "worker-node-02",
      "points": 2,
      "description": "Test pod should be scheduled on worker-node-02"
    },
    {
      "command": "kubectl get pod node-test -n saturn -o jsonpath='{.status.phase}'",
      "expected": "Running",
      "points": 2,
      "description": "Test pod should be running successfully"
    },
    {
      "command": "kubectl get node worker-node-02 -o jsonpath='{.status.allocatable.pods}'",
      "expected": ".*[0-9]+.*",
      "points": 1,
      "description": "Node should report allocatable pod capacity"
    }
  ]
}